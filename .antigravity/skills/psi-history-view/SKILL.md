---
name: PSI 年度歷史視圖 (PSI Yearly History View)
description: 顯示單一產品整年度 PSI 歷史資料的標準與邏輯。
---

# PSI 年度歷史視圖技能 (PSI Yearly History View Skill)

此技能定義了產品年度歷史資料頁面的顯示規範與互動邏輯。

## 1. UI 結構
-   **控制列 (Controls)**:
    -   **顯示年度**: 左右切換年份 (`2024`, `2025`, `2026` 等)。預設為目前年度。
    -   **產品資訊**: 顯示目前檢視的「客戶」與「型號規格」。
    -   **返回圖示**: 返回詳細預測頁面。
-   **年度歷史網格 (Yearly History Grid)**:
    -   **佈局**: 使用 CSS Grid，固定 13 欄 (1 標籤欄 + 12 個月份欄)。
    -   **行項目 (6 Rows)**:
        1.  **預測到貨 (Forecast P)**: 顏色：綠色 (#4CAF50)。
        2.  **預測銷售 (Forecast S)**: 顏色：紅色 (#F44336)。
        3.  **庫存預測 (Forecast I)**: 顏色：黑色 (#000000)，加粗。
        4.  **實際到貨 (Actual P)**: 顏色：深綠色 (#2E7D32)，斜體。
        5.  **實際銷售 (Actual S)**: 顏色：深紅色 (#C62828)，斜體。
        6.  **實際庫存 (Actual I)**: 顏色：黑色 (#000000)，加粗。
    -   **滾動**: 螢幕寬度不足時啟用水平滾動。
    -   **樣式**: 繼承自 `psi-detail-view` 的專業風格。

## 2. 數據邏輯
-   **隨選載入 (On-Demand Loading)**: 進入此頁面時，根據選定的 `client`, `model_spec` 與 `year` 向 API 請求資料。
-   **年度切換**: 改變「顯示年度」時，必須立即觸發 API 請求並更新表格內容。
-   **資料來源**: 對應 Google Sheets 中名為該年度（如 "2026"）的分頁。

## 3. 視覺化
-   **歷史趨勢圖**: 在網格下方使用 Chart.js 圖表顯示 12 個月趨勢。
-   **數據線條**:
    - 分別顯示 預測 (Forecast) 與 實際 (Actual) 線條。
    - 使用與網格一致的顏色規範。
    - 實際值點以實心圓圈標記，預測值點以虛線或淺色呈現。

## 4. 互動行為
-   此頁面為 **唯讀 (Read-only)**，用於年度回顧。
-   年度切換必須平滑且正確載入該年度數據。

## 5. 語言規範
-   嚴格遵守 `localization-rules` 技能。
-   格式：`[年份] 年度歷史數據 - [客戶] [型號規格]`。
